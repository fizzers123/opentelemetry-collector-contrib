resourceSpans:
  - resource:
      attributes:
        - key: resource.required
          value:
            stringValue: foo
        - key: resource.optional
          value:
            stringValue: bar
    scopeSpans:
      - scope: {}
        spans:
          - attributes:
              - key: span.optional
                value:
                  stringValue: bar
            endTimeUnixNano: "1672527601000000000"
            name: proxy
            parentSpanId: ""
            spanId: "1000000000000000"
            startTimeUnixNano: "1672527600000000000"
            status: {}
            traceId: "10000000000000000000000000000000"
          - attributes:
              - key: http.host
                value:
                  stringValue: 10.0.20.20:3001
              - key: net.peer.ip
                value:
                  stringValue: 10.0.10.10
              - key: net.peer.port
                value:
                  stringValue: "54321"
            endTimeUnixNano: "1672527604000000000"
            name: server
            parentSpanId: "1000000000000000"
            spanId: "3000000000000000"
            startTimeUnixNano: "1672527603000000000"
            status: {}
            traceId: "10000000000000000000000000000000"
  - resource:
      attributes:
        - key: service.name
          value:
            stringValue: IPFIX
    scopeSpans:
      - scope:
          name: ipfix
        spans:
          - attributes:
              - key: NoHits-Warning
                value:
                  stringValue: |-
                    No hits were found when searching!
                    This could be due to:
                    - Sampling rate
                    - Bad time settings
                    - Others
              - key: dst.ip
                value:
                  stringValue: 10.0.20.20
              - key: dst.port
                value:
                  stringValue: "3001"
              - key: ipfix.request.flows
                value:
                  intValue: "1"
              - key: ipfix.response.flows
                value:
                  intValue: "0"
              - key: src.ip
                value:
                  stringValue: 10.0.10.10
              - key: src.port
                value:
                  stringValue: "54321"
              - key: z.elasticQuery.request
                value:
                  kvlistValue:
                    values:
                      - key: _source
                        value:
                          boolValue: false
                      - key: fields
                        value:
                          arrayValue:
                            values:
                              - kvlistValue:
                                  values:
                                    - key: field
                                      value:
                                        stringValue: '*'
                                    - key: include_unmapped
                                      value:
                                        stringValue: "true"
                      - key: query
                        value:
                          kvlistValue:
                            values:
                              - key: bool
                                value:
                                  kvlistValue:
                                    values:
                                      - key: must
                                        value:
                                          arrayValue:
                                            values:
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: input.type
                                                              value:
                                                                stringValue: netflow
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: source.ip
                                                              value:
                                                                stringValue: 10.0.10.10
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: source.port
                                                              value:
                                                                stringValue: "54321"
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: destination.ip
                                                              value:
                                                                stringValue: 10.0.20.20
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: destination.port
                                                              value:
                                                                stringValue: "3001"
                                              - kvlistValue:
                                                  values:
                                                    - key: range
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: '@timestamp'
                                                              value:
                                                                kvlistValue:
                                                                  values:
                                                                    - key: gte
                                                                      value:
                                                                        stringValue: "2022-12-31T23:00:04Z"
                                                                    - key: lte
                                                                      value:
                                                                        stringValue: "2022-12-31T23:00:04Z"
              - key: z.elasticQuery.response
                value:
                  kvlistValue:
                    values:
                      - key: _source
                        value:
                          boolValue: false
                      - key: fields
                        value:
                          arrayValue:
                            values:
                              - kvlistValue:
                                  values:
                                    - key: field
                                      value:
                                        stringValue: '*'
                                    - key: include_unmapped
                                      value:
                                        stringValue: "true"
                      - key: query
                        value:
                          kvlistValue:
                            values:
                              - key: bool
                                value:
                                  kvlistValue:
                                    values:
                                      - key: must
                                        value:
                                          arrayValue:
                                            values:
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: input.type
                                                              value:
                                                                stringValue: netflow
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: source.ip
                                                              value:
                                                                stringValue: 10.0.20.20
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: source.port
                                                              value:
                                                                stringValue: "3001"
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: destination.ip
                                                              value:
                                                                stringValue: 10.0.10.10
                                              - kvlistValue:
                                                  values:
                                                    - key: match
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: destination.port
                                                              value:
                                                                stringValue: "54321"
                                              - kvlistValue:
                                                  values:
                                                    - key: range
                                                      value:
                                                        kvlistValue:
                                                          values:
                                                            - key: '@timestamp'
                                                              value:
                                                                kvlistValue:
                                                                  values:
                                                                    - key: gte
                                                                      value:
                                                                        stringValue: "2022-12-31T23:00:04Z"
                                                                    - key: lte
                                                                      value:
                                                                        stringValue: "2022-12-31T23:00:04Z"
            endTimeUnixNano: "1700494981411000000"
            name: 10.0.10.10:54321-10.0.20.20:3001
            parentSpanId: "1000000000000000"
            spanId: "0101010101010101"
            startTimeUnixNano: "1672527604000000000"
            status: {}
            traceId: "10000000000000000000000000000000"
          - attributes:
              - key: fields.destination\.ip.0
                value:
                  stringValue: 10.0.20.20
              - key: fields.destination\.port.0
                value:
                  intValue: "3001"
              - key: fields.event\.duration.0
                value:
                  intValue: "448000000"
              - key: fields.netflow\.ip_next_hop_ipv4_address
                value:
                  stringValue: "null"
              - key: fields.observer\.ip.0
                value:
                  stringValue: 192.168.200.100
              - key: fields.source\.ip.0
                value:
                  stringValue: 10.0.10.10
              - key: fields.source\.port.0
                value:
                  intValue: "54321"
              - key: hits.total.value
                value:
                  stringValue: "null"
              - key: z.elasticResponse
                value:
                  kvlistValue:
                    values:
                      - key: _id
                        value:
                          stringValue: auVm7YsB9hE7__H6VGKl
                      - key: _index
                        value:
                          stringValue: .ds-logs-netflow.log-default-2023.10.30-000002
                      - key: _score
                        value:
                          doubleValue: 5.000001
                      - key: fields
                        value:
                          kvlistValue:
                            values:
                              - key: '@timestamp'
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: "2023-11-20T15:43:07.000Z"
                              - key: agent.ephemeral_id
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: b65c4bd4-dec2-46dc-b2a7-2d8a5ded7d25
                              - key: agent.id
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: bdf672da-9aa2-4205-b423-fc105b6b14e1
                              - key: agent.name
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: quickstart-agent-n5j6z
                              - key: agent.type
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: filebeat
                              - key: agent.version
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 8.10.2
                              - key: data_stream.dataset
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: netflow.log
                              - key: data_stream.namespace
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: default
                              - key: data_stream.type
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: logs
                              - key: destination.ip
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 10.0.20.20
                              - key: destination.locality
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: internal
                              - key: destination.port
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 3001
                              - key: ecs.version
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 8.10.0
                              - key: elastic_agent.id
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: bdf672da-9aa2-4205-b423-fc105b6b14e1
                              - key: elastic_agent.snapshot
                                value:
                                  arrayValue:
                                    values:
                                      - boolValue: false
                              - key: elastic_agent.version
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 8.10.2
                              - key: event.action
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: netflow_flow
                              - key: event.agent_id_status
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: auth_metadata_missing
                              - key: event.category
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: network
                              - key: event.created
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: "2023-11-20T15:43:07.448Z"
                              - key: event.dataset
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: netflow.log
                              - key: event.duration
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 4.48e+08
                              - key: event.end
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: "2023-11-20T15:43:01.411Z"
                              - key: event.ingested
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: "2023-11-20T15:43:08Z"
                              - key: event.kind
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: event
                              - key: event.module
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: netflow
                              - key: event.start
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: "2023-11-20T15:43:00.963Z"
                              - key: event.type
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: connection
                              - key: flow.id
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 9of6On_LptU
                              - key: flow.locality
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: internal
                              - key: input.type
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: netflow
                              - key: netflow.destination_ipv4_address
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 10.0.20.20
                              - key: netflow.destination_transport_port
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 3001
                              - key: netflow.egress_interface
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 1
                              - key: netflow.exporter.address
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 192.168.200.100:12377
                              - key: netflow.exporter.source_id
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 0
                              - key: netflow.exporter.timestamp
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: "2023-11-20T15:43:07.000Z"
                              - key: netflow.exporter.uptime_millis
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 1.7533552e+08
                              - key: netflow.exporter.version
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 9
                              - key: netflow.flow_end_sys_up_time
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 1.75329931e+08
                              - key: netflow.flow_start_sys_up_time
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 1.75329483e+08
                              - key: netflow.ingress_interface
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 1
                              - key: netflow.ip_class_of_service
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 0
                              - key: netflow.ip_version
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 4
                              - key: netflow.octet_delta_count
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 834
                              - key: netflow.packet_delta_count
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 7
                              - key: netflow.protocol_identifier
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 6
                              - key: netflow.source_ipv4_address
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 10.0.10.10
                              - key: netflow.source_transport_port
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 54321
                              - key: netflow.tcp_control_bits
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 27
                              - key: netflow.type
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: netflow_flow
                              - key: network.bytes
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 834
                              - key: network.community_id
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 1:v6MCwUb4XYI1KPRAFQ5jX/W7FaY=
                              - key: network.direction
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: internal
                              - key: network.iana_number
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: "6"
                              - key: network.packets
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 7
                              - key: network.transport
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: tcp
                              - key: network.type
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: ipv4
                              - key: observer.ip
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 192.168.200.100
                              - key: related.ip
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 10.0.10.10
                                      - stringValue: 10.0.20.20
                              - key: source.bytes
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 834
                              - key: source.ip
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: 10.0.10.10
                              - key: source.locality
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: internal
                              - key: source.packets
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 7
                              - key: source.port
                                value:
                                  arrayValue:
                                    values:
                                      - doubleValue: 54321
                              - key: tags
                                value:
                                  arrayValue:
                                    values:
                                      - stringValue: netflow
                                      - stringValue: forwarded
            endTimeUnixNano: "1700494981411000000"
            name: Request - 192.168.200.100
            parentSpanId: "0101010101010101"
            spanId: "0202020202020202"
            startTimeUnixNano: "1700494980963000000"
            status: {}
            traceId: "10000000000000000000000000000000"
          - endTimeUnixNano: "1672527604000000000"
            name: Response - no IPFIX logs found
            parentSpanId: "0101010101010101"
            spanId: "0303030303030303"
            startTimeUnixNano: "1672527604000000000"
            status: {}
            traceId: "10000000000000000000000000000000"
